<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UE Libertador Bolívar - Gestión Administrativa</title>
    
    <!-- PWA Y MOVIL -->
    <meta name="theme-color" content="#1e2b5e">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="assets/img/logo.png">
    
    <link rel="icon" type="image/png" href="assets/img/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

    <!-- CARGADOR INSTITUCIONAL -->
    <div id="main-loader" class="loader-overlay" style="display:none;">
        <div class="loader-box">
            <div class="loader-ring"></div>
            <img src="assets/img/logo.png" class="loader-img">
        </div>
    </div>

    <div id="sidebar-overlay" class="sidebar-overlay" onclick="App.toggleSidebar()"></div>

    <!-- PANTALLA DE ACCESO -->
    <div id="login-screen" class="login-wrapper" style="display:none;">
        <div class="card login-card animate__animated animate__fadeInDown">
            <div class="card-body p-5 text-center">
                <img src="assets/img/logo.png" width="110" class="mb-3">
                <h5 class="fw-bold mb-1" style="color: #1e2b5e;">Sistema Integral de Gestión y Administración Escolar</h5>
                <p class="small text-muted mb-4">UE Libertador Bolívar</p>

                <div id="step-cedula">
                    <input type="number" id="inputCedula" class="form-control mb-3 py-3 rounded-pill shadow-none px-4" placeholder="Cédula de Identidad">
                    <button onclick="App.verificarUsuario()" id="btn-check" class="btn btn-primary w-100 rounded-pill py-3 mb-3 shadow">Continuar</button>
                    <div class="d-flex align-items-center my-3"><hr class="flex-grow-1 opacity-10"> <span class="mx-2 small text-muted">O</span> <hr class="flex-grow-1 opacity-10"></div>
                    <button onclick="App.modalInvitado()" class="btn btn-outline-secondary btn-sm w-100 rounded-pill py-2">Entrar como Invitado</button>
                </div>

                <div id="step-login" style="display:none;">
                    <div class="badge bg-light text-primary p-2 px-3 mb-3 border w-100 text-truncate"><span id="lbl-nombre-login"></span></div>
                    <input type="password" id="inputPass" class="form-control mb-3 py-3 rounded-pill shadow-none px-4" placeholder="Contraseña">
                    <button onclick="App.login()" id="btn-login" class="btn btn-success w-100 rounded-pill py-3 shadow">Ingresar</button>
                    <button onclick="location.reload()" class="btn btn-link btn-sm mt-2 text-decoration-none text-muted">Volver</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ESTRUCTURA APP -->
    <div id="app-wrapper" style="display: none;">
        <aside id="sidebar" class="sidebar-main">
            <div class="sidebar-header" onclick="App.showDashboard()" style="cursor: pointer;">
                <img src="assets/img/logo.png" width="45">
                <div class="ms-3 text-dark">
                    <div class="fw-bold small">UE Libertador Bolívar</div>
                    <div style="font-size: 0.65rem; color: #718096;">Gestión Administrativa</div>
                </div>
                <button class="btn btn-link text-secondary d-lg-none ms-auto p-0" onclick="App.toggleSidebar()">
                    <i class="bi bi-x-lg fs-4"></i>
                </button>
            </div>
            <div id="sidebar-menu" class="accordion accordion-flush mt-3"></div>
        </aside>

        <main id="main-content">
            <header class="navbar sticky-top bg-white border-bottom px-4 py-3">
                <button class="btn btn-light d-lg-none me-3" onclick="App.toggleSidebar()">
                    <i class="bi bi-list fs-4"></i>
                </button>
                <h6 class="mb-0 fw-bold text-secondary text-truncate" id="page-title">Panel de Control</h6>
                <div class="ms-auto d-flex align-items-center">
                    <span class="small fw-medium me-3 text-muted d-none d-md-inline" id="user-display-name"></span>
                    <div class="avatar-circle" onclick="App.logout()" style="cursor:pointer">U</div>
                </div>
            </header>
            <div id="dashboard-view" style="display:none;"></div>
            <div id="dynamic-view" style="display:none;"></div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="assets/js/config.js"></script>
    <script src="assets/js/app.js"></script>

    <!-- REGISTRO DE SERVICE WORKER PARA INSTALACIÓN -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker registrado correctamente'))
                    .catch(err => console.warn('Error al registrar Service Worker', err));
            });
        }
    </script>
</body>
</html>